# ğŸ”¥ POC-bomber
ğŸ¦„ **POC bomber æ˜¯ä¸€æ¬¾æ¼æ´æ£€æµ‹/åˆ©ç”¨å·¥å…·ï¼Œæ—¨åœ¨åˆ©ç”¨å¤§é‡é«˜å±å®³æ¼æ´çš„POC/EXPå¿«é€Ÿè·å–ç›®æ ‡æœåŠ¡å™¨æƒé™**
                                  
æœ¬é¡¹ç›®æ”¶é›†äº’è”ç½‘å„ç§å±å®³æ€§å¤§çš„ RCE Â· ä»»æ„æ–‡ä»¶ä¸Šä¼  Â· ååºåˆ—åŒ– Â· sqlæ³¨å…¥ ç­‰é«˜å±å®³ä¸”èƒ½å¤Ÿè·å–åˆ°æœåŠ¡å™¨æ ¸å¿ƒæƒé™çš„æ¼æ´POC/EXPï¼Œå¹¶é›†æˆåœ¨ POC bomber æ­¦å™¨åº“ä¸­ï¼Œåˆ©ç”¨å¤§é‡é«˜å±å®³POCå¯¹å•ä¸ªæˆ–å¤šä¸ªç›®æ ‡è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä»¥æ­¤åœ¨å¤§é‡èµ„äº§ä¸­å¿«é€Ÿè·å–å‘ç°è„†å¼±æ€§ç›®æ ‡ï¼Œè·å–ç›®æ ‡æœåŠ¡å™¨æƒé™ã€‚é€‚ç”¨åœºæ™¯åŒ…æ‹¬ä½†ä¸ä»…é™äºä»¥ä¸‹:
1. çº¢è“å¯¹æŠ—æˆ–hvvä¸­å¸®åŠ©çº¢é˜Ÿåœ¨å¤§é‡èµ„äº§ä¸­å¿«é€Ÿæ‰¾åˆ°çªç ´å£è¿›å…¥å†…ç½‘
2. å†…ç½‘å®‰å…¨æµ‹è¯•ï¼Œæ¨ªå‘ç§»åŠ¨
3. åˆ©ç”¨æ–°å‹0dayå¯¹ä¼ä¸šèµ„äº§è¿›è¡Œæ‰¹é‡è¯„ä¼°

## ğŸ“ ç®€ä»‹
POC bomber çš„pocæ”¯æŒweblogicï¼Œtomcatï¼Œapacheï¼Œjbossï¼Œnginxï¼Œstruct2ï¼Œthinkphp2x3x5xï¼Œspringï¼Œredisï¼Œjenkinsï¼Œphpè¯­è¨€æ¼æ´ï¼Œshiroï¼Œæ³›å¾®OAï¼Œè‡´è¿œOAï¼Œé€šè¾¾OAç­‰æ˜“å—æ”»å‡»ç»„ä»¶çš„æ¼æ´æ£€æµ‹ï¼Œæ”¯æŒè°ƒç”¨dnslogå¹³å°æ£€æµ‹æ— å›æ˜¾çš„rce(åŒ…æ‹¬log4j2çš„æ£€æµ‹)ï¼Œæ”¯æŒå•ä¸ªç›®æ ‡æ£€æµ‹å’Œæ‰¹é‡æ£€æµ‹ï¼Œç¨‹åºé‡‡ç”¨é«˜å¹¶å‘çº¿ç¨‹æ± ï¼Œæ”¯æŒè‡ªå®šä¹‰å¯¼å…¥poc/expï¼Œå¹¶èƒ½å¤Ÿç”Ÿæˆæ¼æ´æŠ¥å‘Š  
POC bomberé»˜è®¤ä½¿ç”¨éªŒè¯æ¨¡å¼è¿›è¡Œpocçš„éªŒè¯ï¼Œå¦‚è¿”å›ç»“æœä¸­attackçš„å€¼ä¸ºTrueæ—¶ï¼Œå¯ä»¥åŠ å‚æ•°(--attack)è¿›å…¥æ”»å‡»æ¨¡å¼ç›´æ¥è°ƒç”¨expè¿›è¡Œæ”»å‡»(éœ€è¦æŒ‡å®špocæ–‡ä»¶å)ï¼Œè¾¾åˆ°ä¸€é”®getshell


## ğŸ’» Screenshots    
#### ğŸ† éªŒè¯æ¨¡å¼
        python3 pocbomber.py -u http://xxx.xxx
![image](https://user-images.githubusercontent.com/71172892/168099161-f46a54f7-562b-4ba5-a751-1d65492b17d9.png)
![image](https://user-images.githubusercontent.com/71172892/147481630-f8b94566-572f-4d89-a874-dc01f5041377.png)
![verifyæ¨¡è¯•æ¼”ç¤º](https://user-images.githubusercontent.com/71172892/148684886-98b0f1ff-76f5-48d3-8d2d-932635392a33.gif)


#### âš¡ï¸ æ”»å‡»æ¨¡å¼
        python3 pocbomber.py -u http://xxx.xxx --poc="thinkphp2_rce.py" --attack
![image](https://user-images.githubusercontent.com/71172892/147629887-def9d18e-f6aa-466a-ab2c-2538752b82aa.png)
![image](https://user-images.githubusercontent.com/71172892/148206720-86f77246-301c-481f-a16c-b36047f72d7c.png)
![attackæ¨¡å¼æ¼”ç¤º](https://user-images.githubusercontent.com/71172892/148684097-67b59320-6758-458d-ac6b-ae219c327924.gif)



## ğŸ”§ å®‰è£…
      git clone https://github.com/tr0uble-mAker/POC-bomber.git            
      cd POC-bomber
      pip install -r requirements.txt
## ğŸš€ ç”¨æ³•      
        æŸ¥çœ‹ç”¨æ³•:     python3 pocbomber.py
        
        æ¨¡å¼:
                è·å–poc/expä¿¡æ¯:   python3 pocbomber.py --show
                å•ç›®æ ‡æ£€æµ‹:        python3 pocbomber.py -u http://xxx.xxx.xx
                æ‰¹é‡æ£€æµ‹:          python3 pocbomber.py -f url.txt -o report.txt 
                æŒ‡å®špocæ£€æµ‹:       python3 pocbomber.py -f url.txt --poc="thinkphp2_rce.py"
                expæ”»å‡»æ¨¡å¼:       python3 pocbomber.py -u ç›®æ ‡url --poc="æŒ‡å®špocæ–‡ä»¶" --attack
        å‚æ•°:
                -u  --url      ç›®æ ‡url
                -f  --file     æŒ‡å®šç›®æ ‡urlæ–‡ä»¶   
                -o  --output   æŒ‡å®šç”ŸæˆæŠ¥å‘Šçš„æ–‡ä»¶(é»˜è®¤ä¸ç”ŸæˆæŠ¥å‘Š)
                -p  --poc      æŒ‡å®šå•ä¸ªæˆ–å¤šä¸ªpocè¿›è¡Œæ£€æµ‹, ç›´æ¥ä¼ å…¥pocæ–‡ä»¶å, å¤šä¸ªpocç”¨(,)åˆ†å¼€
                -t  --thread   æŒ‡å®šçº¿ç¨‹æ± æœ€å¤§å¹¶å‘æ•°é‡(é»˜è®¤30)
                --show         å±•ç¤ºpoc/expè¯¦ç»†ä¿¡æ¯
                --attack       ä½¿ç”¨pocæ–‡ä»¶ä¸­çš„expè¿›è¡Œæ”»å‡»
                --dnslog       ä½¿ç”¨dnslogå¹³å°æ£€æµ‹æ— å›æ˜¾æ¼æ´(é»˜è®¤ä¸å¯ç”¨dnslog,å¯åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨)
                
## ğŸ”† é…ç½®æ–‡ä»¶    
      /inc/config.py   
      
          


## âš ï¸ å¸¸è§é—®é¢˜
1. ç¨‹åºä¸å®‰è£…requirements.txtå°±å¯ä»¥ç›´æ¥è¿è¡Œï¼Œåªä¾èµ–requestsç¬¬ä¸‰æ–¹åº“ï¼Œå…¶ä»–åº“å®‰è£…ä¸ä¸Šä¸å½±å“ç¨‹åºè¿è¡Œï¼Œä½†æœ‰äº›pocä¼šä¸èƒ½æ£€æµ‹
2. log4j2å‘½ä»¤æ‰§è¡Œæ¼æ´çš„æ£€æµ‹ï¼šéœ€è¦æ·»åŠ  --dnslog  å‚æ•° 
3. æ— å›æ˜¾æ¼æ´æ£€æµ‹é»˜è®¤ä½¿ç”¨ dnslog.cn å¹³å°ä¸”é»˜è®¤å…³é—­, è¦å¼€å¯éœ€å‰å¾€é…ç½®æ–‡ä»¶å°† dnslog_flag å¼€å…³ç½®ä¸ºTrue  
4. éœ€è¦æŒ‡å®šä¸€ä¸ªpocæ‰èƒ½è°ƒç”¨--attackæ”»å‡»æ¨¡å¼


## ğŸ“ ç›®å½•ç»“æ„:
       
      +--------- poc_bomber.py (å¯åŠ¨ POC-bomber)
      | 
      +--------- inc(å­˜æ”¾æ”¯æ’‘ POC-bomber æ¡†æ¶è¿è¡Œçš„æ ¸å¿ƒæ–‡ä»¶)
      |
      \--------- pocs(POCå­˜æ”¾åˆ—è¡¨)----------- framework(å­˜æ”¾æ¡†æ¶æ¼æ´POC)
                                      |
                                      |------ middleware(å­˜æ”¾ä¸­é—´ä»¶æ¼æ´POC)
                                      |
                                      |------ ports(å­˜æ”¾å¸¸è§ç«¯å£æ¼æ´,ä¸»æœºæœåŠ¡æ¼æ´POC)
                                      |
                                       \----- webs(å­˜æ”¾å¸¸è§webé¡µé¢æ¼æ´POC)
      
      


## ğŸ“– POCç¼–å†™è§„åˆ™     
POC bomberæ”¯æŒè‡ªå®šä¹‰ç¼–å†™poc          
pocç»Ÿä¸€è¦æ±‚python3ç¼–å†™ï¼Œå…·æœ‰verifyå’Œattack(éå¿…é¡»)ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«è¿›è¡ŒéªŒè¯å’Œæ”»å‡»,                     
#### ğŸ‘» æ¼æ´éªŒè¯å‡½æ•°(verify)ç¼–å†™åº”è¯¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶:                   
1. å‡½æ•°åä¸º verify ï¼Œ å‚æ•°æ¥æ”¶ç›®æ ‡urlçš„å‚æ•°           
2. å‡½æ•°çš„è¿”å›ç»“æœä»¥å­—å…¸çš„å½¢å¼è¿”å›å¹¶ä¸”å…·æœ‰nameå’Œvulnerableä¸¤ä¸ªé”®å€¼ï¼Œnameè¯´æ˜æ¼æ´åç§°ï¼Œvulnerableé€šè¿‡Trueå’ŒFalseçš„çŠ¶æ€è¡¨æ˜æ¼æ´æ˜¯å¦å­˜åœ¨
3. å¦‚æœå­˜åœ¨æ¼æ´è¦å°†è¿”å›å­—å…¸ä¸­vulnerableçš„å€¼ç½®ä¸ºTrue, å¹¶æ·»åŠ ç›®æ ‡url, æ¼æ´åˆ©ç”¨ç›¸å…³ç½‘é¡µç­‰ä¿¡æ¯
4. ç”¨tryæ–¹æ³•å°è¯•éªŒè¯ï¼Œä½¿ç”¨requestç­‰å‘é€æ•°æ®åŒ…æ—¶è¦è®¾ç½®è¶…æ—¶æ—¶é—´, é¿å…pocä¼šå¡æ­»                              
  
        def verify(url):                        
            relsult = {                                            
                'name': 'Thinkphp5 5.0.22/5.1.29 Remote Code Execution Vulnerability',                          
                'vulnerable': Falseï¼Œ
                'attack'ï¼š Falseï¼Œ        # å¦‚æœæœ‰expæ”¯æŒattackæ¨¡å¼å°†attackçš„å€¼ç½®ä¸ºTrue
            }              
            try:                    
                ......        
                (ç”¨ä»»æ„æ–¹æ³•æ£€æµ‹æ¼æ´)             
                ......
                if å­˜åœ¨æ¼æ´:
                    relsult['vulnerable'] = True     # å°†relsultçš„vulnerableçš„å€¼ç½®ä¸ºTrue
                    relsult['url'] = url             # è¿”å›éªŒè¯çš„url
                    relust['xxxxx'] = 'xxxxx'        # å¯ä»¥æ·»åŠ è¯¥æ¼æ´ç›¸å…³æ¥æºç­‰ä¿¡æ¯   
                    ......           
                    return relsult     # å°†vulnerableå€¼ä¸ºTrueçš„relsultè¿”å›                   
                else:  # ä¸å­˜åœ¨æ¼æ´           
                    return relsult    # è‹¥ä¸å­˜åœ¨æ¼æ´å°†vulnerableå€¼ä¸ºFalseçš„relsultè¿”å›

            execpt:
                return relsult

å¦‚æœæœ‰expå¯ä»¥ç¼–å†™ attack å‡½æ•°ä½œä¸ºexpæ”»å‡»å‡½æ•°ï¼Œ
#### ğŸƒ æ¼æ´æ”»å‡»å‡½æ•°(attack)ç¼–å†™åº”è¯¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š
1. å‡½æ•°åä¸º attack ï¼Œ å‚æ•°æ¥æ”¶ç›®æ ‡urlçš„å‚æ•°  
2. å¹¶åœ¨tryä¸­ç¼–å†™expä»£ç è¿›è¡Œæ”»å‡», å¯ä»¥ä¸ç”¨æˆ·äº¤äº’è¾“å…¥       
3. ç¼–å†™å®Œæˆåå°†è¯¥æ¼æ´çš„verifyå‡½æ•°è¿”å›å­—å…¸ä¸­attackå€¼ç½®ä¸ºTrue 
4. æ”»å‡»æˆåŠŸåè¿”å›Trueï¼Œå…¶ä»–åŸå› å¤±è´¥çš„è¯è¿”å›Falseå³å¯        
      
        def attack(url):    
          try:            
              ........................................            
                æ”»å‡»ä»£ç (æ‰§è¡Œå‘½ä»¤æˆ–åå¼¹shellä¸Šä¼ æœ¨é©¬ç­‰)             
              ........................................
              return True
          except:               
              return False    
                      
                      
ç¼–å†™å®Œæˆåçš„pocç›´æ¥æ”¾å…¥ /pocs ç›®å½•ä¸‹ä»»æ„ä½ç½®å³å¯è¢«é€’å½’è°ƒç”¨!    


é¡¹ç›®æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿å„ä½å¸ˆå‚…è´¡çŒ®pocå…±ç­‘ç½‘ç»œå®‰å…¨ï¼  
æœ‰é—®é¢˜æ¬¢è¿issuesç•™è¨€: https://github.com/tr0uble-mAker/POC-bomber/issues    
è”ç³»: 929305053@qq.com    
